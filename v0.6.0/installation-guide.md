# Руководство по установке и запуску CRM-системы

Данное руководство поможет вам установить и запустить CRM-систему для бизнеса по установке кондиционеров.

## Системные требования

- Python 3.8+ (рекомендуется 3.10+)
- pip (менеджер пакетов Python)
- 100 МБ свободного места на диске
- Операционная система: Windows, Linux, macOS

## Шаг 1: Подготовка окружения

1. **Скачайте и установите Python**, если у вас его еще нет:
   - Windows: скачайте установщик с [официального сайта Python](https://www.python.org/downloads/) и следуйте инструкциям
   - Ubuntu/Debian: `sudo apt update && sudo apt install python3 python3-pip python3-venv`
   - macOS: `brew install python` (требует установленного [Homebrew](https://brew.sh/))

2. **Проверьте установку Python и pip**:
   ```bash
   python --version
   pip --version
   ```

## Шаг 2: Скачивание проекта

1. **Клонируйте репозиторий** (если используете Git):
   ```bash
   git clone https://github.com/your-username/aircon-crm.git
   cd aircon-crm
   ```

   или **скачайте и распакуйте архив с проектом** в удобную директорию.

2. **Перейдите в директорию проекта**:
   ```bash
   cd путь/к/проекту
   ```

## Шаг 3: Создание виртуального окружения

1. **Создайте виртуальное окружение**:
   ```bash
   # Windows
   python -m venv venv

   # Linux/macOS
   python3 -m venv venv
   ```

2. **Активируйте виртуальное окружение**:
   ```bash
   # Windows
   venv\Scripts\activate

   # Linux/macOS
   source venv/bin/activate
   ```

## Шаг 4: Установка зависимостей

1. **Установите необходимые пакеты**:
   ```bash
   pip install -r requirements.txt
   ```

## Шаг 5: Запуск приложения

1. **Запустите приложение**:
   ```bash
   # Windows
   python app.py

   # Linux/macOS
   python3 app.py
   ```

2. **Доступ к приложению**:
   - Откройте веб-браузер и перейдите по адресу: `http://localhost:8000`
   - Для доступа из локальной сети используйте IP-адрес вашего компьютера вместо localhost

## Шаг 6: Первоначальная настройка

При первом запуске необходимо выполнить настройку системы:

1. **Установите начальный баланс компании**:
   - Перейдите в раздел "Финансы"
   - Нажмите кнопку "Установить начальный баланс"
   - Введите сумму и подтвердите

2. **Добавьте владельца бизнеса**:
   - Перейдите в раздел "Сотрудники"
   - Нажмите "Добавить сотрудника"
   - Выберите тип "владелец" и заполните остальные поля

3. **Добавьте основные услуги**:
   - Перейдите в раздел "Услуги"
   - Добавьте базовые услуги для монтажа, кондиционеров и доп. услуг

## Дополнительные настройки

### Изменение порта запуска

По умолчанию приложение запускается на порту 8000. Чтобы изменить порт:

1. Откройте файл `app.py` в текстовом редакторе
2. Найдите строку `uvicorn.run("app:app", host="0.0.0.0", port=8000, reload=True)`
3. Измените значение `port=8000` на нужное вам (например, `port=8080`)
4. Сохраните файл и перезапустите приложение

### Настройка базы данных

По умолчанию используется SQLite с файлом базы данных `aircon_crm.db` в корневой директории проекта. Для изменения:

1. Откройте файл `config.py`
2. Измените параметр `DATABASE_URL`
3. Сохраните файл и перезапустите приложение

## Устранение неполадок

### Проблема: Ошибка при установке зависимостей

**Решение**:
- Убедитесь, что у вас установлена актуальная версия pip: `pip install --upgrade pip`
- В Windows может потребоваться установка C++ Build Tools: скачайте и установите [Microsoft C++ Build Tools](https://visualstudio.microsoft.com/visual-cpp-build-tools/)

### Проблема: Приложение не запускается

**Решение**:
- Проверьте, что виртуальное окружение активировано
- Удостоверьтесь, что все зависимости установлены: `pip list`
- Проверьте, не занят ли порт 8000 другим приложением

### Проблема: Не удается получить доступ к приложению по сети

**Решение**:
- Проверьте настройки сетевого экрана
- Убедитесь, что приложение запущено с параметром `host="0.0.0.0"`

## Обновление приложения

Для обновления приложения:

1. Остановите текущий экземпляр (Ctrl+C в терминале)
2. Скачайте новую версию или выполните `git pull`
3. Обновите зависимости: `pip install -r requirements.txt`
4. Запустите приложение: `python app.py`

## Дополнительная информация

Для ознакомления с API приложения после запуска можно открыть документацию Swagger:
- `http://localhost:8000/docs` - интерактивная документация API
- `http://localhost:8000/redoc` - альтернативный вид документации